LIB_VERMAJOR = 0
LIB_VERMINOR = 1
LIB_MAPI_CCFG_FILENAME = libmapi_ccfg.so

LIB_CFLAGS  = $(CFLAGS) -shared -fPIC -I$(STAGING_DIR)/usr/include
LIB_MAPI_CCFG_LDFLAGS = $(LDFLAGS) -Wl,-soname,$(LIB_MAPI_CCFG_FILENAME).$(LIB_VERMAJOR).$(LIB_VERMINOR)

LIB_MAPI_CCFG_OBJ = mid_mapi_ccfg.o

all: libmapi_ccfg

libmapi_ccfg:
	$(CC) $(LIB_CFLAGS) -c -o mid_mapi_ccfg.o mid_mapi_ccfg.c
	$(CC) $(LIB_CFLAGS) $(LIB_MAPI_CCFG_LDFLAGS) \
		-o $(LIB_MAPI_CCFG_FILENAME).$(LIB_VERMAJOR).$(LIB_VERMINOR) $(LIB_MAPI_CCFG_OBJ)
	ln -sf $(LIB_MAPI_CCFG_FILENAME).$(LIB_VERMAJOR).$(LIB_VERMINOR) $(LIB_MAPI_CCFG_FILENAME)
	ln -sf $(LIB_MAPI_CCFG_FILENAME).$(LIB_VERMAJOR).$(LIB_VERMINOR) $(LIB_MAPI_CCFG_FILENAME).$(LIB_VERMAJOR)

clean:
	rm -f $(LIB_MAPI_CCFG_FILENAME) *.o
